<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>TrendTracker â€“ Edit Watch Rule</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >

  <style>
    body {
      background: radial-gradient(circle at top, #0b1120 0, #020617 50%, #000000 100%);
      color: #f9fafb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .navbar {
      background: linear-gradient(90deg, #0A1A44, #009FE3);
    }
    .navbar .nav-link {
      color: #e5e7eb;
      font-weight: 500;
    }
    .navbar .nav-link.active {
      background-color: rgba(255,255,255,0.2);
    }
    .brand-accent {
      color: #ffffff;
      font-weight: 700;
    }

    .center-wrap {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1rem 3rem;
    }

    .edit-card {
      max-width: 720px;
      width: 100%;
      background: rgba(15,23,42,0.9);
      border-radius: 22px;
      border: 1px solid rgba(148,163,184,0.4);
      box-shadow: 0 24px 60px rgba(15,23,42,0.8);
      padding: 2.25rem 2rem;
      position: relative;
      overflow: hidden;
    }

    .edit-card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(59,130,246,0.18), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(239,68,68,0.16), transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(56,189,248,0.14), transparent 55%);
      opacity: 0.7;
      filter: blur(35px);
      pointer-events: none;
    }

    .edit-inner {
      position: relative;
      z-index: 1;
    }

    .pill-label {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.2rem 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,0.8);
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: .12em;
      color: #e5e7eb;
      margin-bottom: .75rem;
    }

    .btn-primary-bmw {
      border-radius: 999px;
      border: none;
      background: linear-gradient(90deg, #009FE3, #0A1A44);
      color: #ffffff;
      font-weight: 600;
      padding-inline: 1.4rem;
    }
    .btn-primary-bmw:hover {
      filter: brightness(1.1);
    }

    .btn-outline-light-bmw {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      color: #e5e7eb;
      background: transparent;
      padding-inline: 1.2rem;
    }
    .btn-outline-light-bmw:hover {
      background: rgba(248,250,252,0.1);
    }

    .form-control,
    .form-check-input {
      background-color: rgba(15,23,42,0.95);
      color: #f9fafb;
      border-color: rgba(148,163,184,0.7);
    }
    .form-control:focus {
      box-shadow: 0 0 0 1px #38bdf8;
      border-color: #38bdf8;
    }
    .form-check-label {
      font-size: 0.9rem;
    }
    .text-hint {
      font-size: 0.85rem;
      color: #9ca3af;
    }
  </style>
</head>
<body>
<nav class="navbar navbar-dark mb-4">
  <div class="container-fluid">
    <a class="navbar-brand mb-0 h1" href="/">
      Trend<span class="brand-accent">Tracker</span>
    </a>
    <ul class="nav nav-pills">
      <li class="nav-item">
        <a class="nav-link" href="/">Search</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/watch">Watching</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/analytics">Analytics</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/profile">Profile</a>
      </li>
    </ul>
  </div>
</nav>

<div class="center-wrap">
  <div class="edit-card">
    <div class="edit-inner">
      <div class="mb-2">
        <span class="pill-label">Set up your watch rule</span>
      </div>
      <h3 class="mb-2">{{ rule.query }}</h3>
      <p class="text-hint mb-4">
        Start from the listing you liked, then expand it across other marketplaces and refine your criteria.
      </p>

      <form method="POST">
        <div class="mb-3">
          <label class="form-label">Marketplaces to watch</label>
          <div class="row">
            {% for value, label in all_sites %}
            <div class="col-6 col-md-4 mb-2">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="sites"
                  id="site-{{ value }}"
                  value="{{ value }}"
                  {% if value in rule.sites %}checked{% endif %}
                >
                <label class="form-check-label" for="site-{{ value }}">
                  {{ label }}
                </label>
              </div>
            </div>
            {% endfor %}
          </div>
          <div class="text-hint mt-1">
            Tip: enable simulated sites to see how the same item is priced elsewhere.
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label">Max price (USD)</label>
          <input
            type="number"
            class="form-control"
            step="1"
            min="0"
            name="max_price"
            value="{{ max_price_input }}"
            placeholder="e.g. 150"
          >
          <div class="text-hint mt-1">
            Defaults to the price of the listing you clicked, but you can raise or lower it.
          </div>
        </div>

        <div class="mb-4">
          <label class="form-label">Tags / keywords (optional)</label>
          <input
            type="text"
            class="form-control"
            name="tags"
            value="{{ tags_input }}"
            placeholder="e.g. vintage, m-tech, e46, rare"
          >
          <div class="text-hint mt-1">
            We'll match listings that contain <strong>any</strong> of these words in the title.
          </div>
        </div>

        <div class="d-flex flex-wrap gap-2 justify-content-end">
          <a href="/watch" class="btn btn-outline-light-bmw">
            Cancel
          </a>
          <button type="submit" class="btn btn-primary-bmw">
            Save &amp; View Matches
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
